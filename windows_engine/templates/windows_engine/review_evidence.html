{% extends "main/master.html" %}
{% load static %}
{% block content%}
<script src="{% static 'windows_engine/js/main.js'%}"></script>
<script src="{% static 'windows_engine/js/pstree.js'%}"></script>
<script src="{% static 'windows_engine/js/timeline.js'%}"></script>
<script src="{% static 'windows_engine/js/tag.js'%}"></script>
<script src="{% static 'windows_engine/js/tree.js'%}"></script>
<link rel="stylesheet" href="{% static 'windows_engine/css/treejs.min.css'%}" id="treejs_styles">
<link rel="stylesheet" type="text/css" href="{% static 'windows_engine/css/windows_engine.css'%}" />

<link rel="stylesheet" type="text/css" href="{% static 'windows_engine/css/windows_engine.css'%}" />
<link href="https://cdn.datatables.net/v/bs5/dt-1.13.6/r-2.5.0/sc-2.2.0/sp-2.2.0/sl-1.7.0/datatables.min.css" rel="stylesheet">
<script src="https://cdn.datatables.net/v/bs5/dt-1.13.6/r-2.5.0/sc-2.2.0/sp-2.2.0/sl-1.7.0/datatables.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-base.min.js" type="text/javascript"></script>
<script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-exports.min.js?hcode=a0c21fc77e1449cc86299c5faa067dc4"></script>
<script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-graph.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-sunburst.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.anychart.com/releases/8.11.0/css/anychart-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.anychart.com/releases/8.11.0/fonts/css/anychart-font.min.css" />

<script src="{% static 'windows_engine/js/visualisation.js'%}"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.5/joint.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.4.1/backbone.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.5/joint.js"></script>
<script src="https://dagrejs.github.io/project/dagre/latest/dagre.min.js"></script>
<script src="https://dagrejs.github.io/project/graphlib/latest/graphlib.min.js"></script>

<nav class="navbar navbar-expand-lg bg-light">
    <div class="container-fluid">
        <div class="navbar-brand">
            <i class="fas fa-suitcase"></i>
            Case X
            <i class="fas fa-chevron-right"></i>
            Evidence Y
        </div>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="nav navbar-nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item">
                    <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true"><i class="fas fa-chart-bar"></i>&nbsp;Overview</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false"><i class="fas fa-timeline"></i>&nbsp;Timeline</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="pills-contact-tab" data-bs-toggle="pill" data-bs-target="#pills-contact" type="button" role="tab" aria-controls="pills-contact" aria-selected="false"><i class="fas fa-fingerprint"></i>&nbsp;Credentials</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="pills-disabled-tab" data-bs-toggle="pill" data-bs-target="#pills-disabled" type="button" role="tab" aria-controls="pills-disabled" aria-selected="false" disabled>Disabled</button>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active" style="height: 93vh;" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab" tabindex="0">
            <div class="row mt-2">
                <div class="col-md-6 col-xl-3 col-sm-12">
                    <div class="card shadow border-start-primary py-2">
                        <div class="card-body">
                            <div class="row align-items-center no-gutters">
                                <div class="col-auto"><i class="fas fa-folder-tree fa-2x text-gray-600"></i></div>

                                <div class="col me-2">
                                    <div class="text-uppercase fw-bold text-xs mb-1"><span>Process Tree</span></div>
                                </div>
                            </div>
                            <hr class="horizontal dark mt-0">
                            <div class="card-body">
                                <div id="container"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-xl-9 col-sm-12">
                    <div class="row">
                        <div class="col-md-6 col-xl-4">
                            <div class="card shadow border-start-primary py-2 process_id">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col-auto"><i class="fas fa-circle-info fa-2x text-gray-600"></i></div>
                                        <div class="col me-2">
                                            <div class="text-uppercase fw-bold text-xs mb-1"><span>METADATA : </span><span class="process_title"></span></span></div>
                                        </div>
                                    </div>
                                    <hr class="horizontal dark mt-0">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item p_pid"></li>
                                        <li class="list-group-item p_offset"></li>
                                        <li class="list-group-item p_threads"></li>
                                        <li class="list-group-item p_handles"></li>
                                        <li class="list-group-item p_session"></li>
                                        <li class="list-group-item p_wow64"></li>
                                        <li class="list-group-item p_ctime"></li>
                                        <li class="list-group-item p_etime"></li>
                                      </ul>
                                      <a class="btn btn-sm btn-dark investigate-btn">Investigate</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-8">
                            <div class="card shadow border-start-primary py-2">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col-auto"><i class="fas fa-toolbox fa-2x text-gray-600"></i></div>
                                        <div class="col me-2">
                                            <div class="text-uppercase fw-bold text-xs mb-1"><span>Investigation Tools</span></div>
                                        </div>
                                    </div>
                                    <hr class="horizontal dark mt-0">
                                    <div class="row">
                                        <div class="col-md-4 col-xl-3 col-sm-6">
                                            <div class="card shadow border-start-primary py-2 card_clickable">
                                                <div class="card-body">
                                                    <div class="row align-items-center no-gutters">
                                                        <div class="col-auto"><i class="fas fa-grip-vertical fa-2x text-gray-600"></i></div>
                                                        <div class="col me-2">
                                                            <div class="text-uppercase fw-bold text-xs"><span>HANDLES</span></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <div class="card shadow border-start-primary py-2 process_id">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col-auto"><i class="fas fa-circle-info fa-2x text-gray-600"></i></div>
                                        <div class="col me-2">
                                            <div class="text-uppercase fw-bold text-xs mb-1"><span>VISUALISATION</span></span></span></div>
                                        </div>
                                    </div>
                                    <hr class="horizontal dark mt-0">
                                    <div class="col-12" style="height: 300px;">
                                        <div id="overview_graph" ></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
            
        </div>
        <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab" tabindex="0">
            <div style="height:20rem;" id="timeline"></div>
            <table id="timeline_datatable" class="table table-sm table-responsive table-hover">
                <thead>
                    <tr>
                        <th>Created Date</th>
                        <th>Accessed Date</th>
                        <th>Changed Date</th>
                        <th>Description</th>
                        <th>Modified Date</th>
                        <th>Plugin</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
        <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab" tabindex="0">...</div>
        <div class="tab-pane fade" id="pills-disabled" role="tabpanel" aria-labelledby="pills-disabled-tab" tabindex="0">...</div>
      </div>
</div>

<div class="main" id="{{evidence.dump_id}}"></div>

<script>
    var cpu = "{% static 'windows_engine/images/cpu.svg' %}"
</script>
{% endblock content%}