<!-- Investigation network_scan artifacts -->
<button class="btn btn-warn-d" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNetGraph" aria-expanded="false" aria-controls="collapseNetscan">
  Network Graph
</button>
<div class="collapse mt-5" id="collapseNetGraph">
  <div id="net_graph" style="height:50rem;"></div>
  <script>
    anychart.onDocumentReady(function () {
      // create data
      var data = JSON.parse("{{network_graph|escapejs}}");
      console.log(data);
      // create a data tree
      // create a chart and set the data
      var chart = anychart.graph(data);
      chart.background().fill("#293b58");
      chart.nodes().labels().enabled(true);

      chart.nodes().labels().format("{%id} ({%Owner(s)})");
      chart.nodes().labels().fontSize(12);
      chart.nodes().labels().fontColor("#ffffff");
      chart.nodes().labels().fontWeight(600);
      // set the chart title
      chart.title("Network Communications");
      // configure tooltips of nodes
      chart.nodes().tooltip().useHtml(true);
      chart.nodes().tooltip().format(
      "<span style='font-weight:bold'>Involved PIDs : {%Involved_PIDs}</span><br><spanstyle='font-weight:bold'>Owner : {%Owner(s)}</span><br><span style='font-weight:bold'>Local Ports: {%Local_Ports}</span>"
      );
      // set the container id
      chart.container("net_graph");

      // initiate drawing the chart
      chart.draw();
    });
  </script>
</div>
